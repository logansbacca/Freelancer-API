<h2>Edit your profile</h2>
<form action="/users" method="POST">
  <div class="form-group">
    <label for="userName">Username</label>
    <input type="text" class="form-control" name="userName" id="userName" value="{{ user.userName }}">
  </div>

  <div class="form-group">
    <label for="name">Email</label>
    <input type="text" class="form-control" name="email" id="email" value="{{ user.email }}">
  </div>

  <div class="form-group">
    <label for="name">Password</label>
    <input type="text" class="form-control" name="password" id="password" >

    </form> 
    
  </div>

  <button class="btn btn-primary" type="submit">Update</button>


<button class="btn btn-primary" onclick="deleteaccount()">Delete Account</button>

<script>

  document.addEventListener( 'submit', ( e ) => {
        e.preventDefault() 
        fetch("/api/user/{{user._id}}", {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify( {
                userName: document.querySelector( 'input[name="userName"]' ).value,
                password: document.querySelector( 'input[name="password"]' ).value,
                email: document.querySelector( 'input[name="email"]' ).value
            } )        
        } ).then( async res => {
            res = await res.json();
            console.log(res)
            window.location.href = "/user/login";
            console.log('User updated!');
        }, err => {
            console.log("error: "+ err)
        });
    } );

function deleteaccount() {

        fetch( "/api/user/{{user._id}}", {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            }
        } ).then( async res => {
            res = await res.json();
            console.log(res)
            window.location.href = "/user/login";
            console.log('User deleted!');
        }, err => {
            console.log("error: "+ err)
        
        });
}
</script>